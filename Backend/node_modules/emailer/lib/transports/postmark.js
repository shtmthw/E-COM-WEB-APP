var structr = require("structr"),
postmark = require("postmark");


module.exports = structr({

	/**
	 */

	"__construct": function(options) {
		this._postmark = postmark(options.apiKey);
		this._options = options;
	},

	/**
	 */

	"send": function(options, callback) {

		var ops = {
			To: options.to,
			From: options.from || this._options.from,
			Subject: options.subject
		};

		if(options.textBody) ops.TextBody = options.textBody;
		if(options.htmlBody) ops.HtmlBody = options.htmlBody;

		
		//TODO - wrap callback
		this._postmark.send(ops, function(err, result) {
			if(err) return callback(new Error(err.message));
			callback(null, result);
		});
	}
});


module.exports.transformInboundMessage = function(req) {
	//TODO
}